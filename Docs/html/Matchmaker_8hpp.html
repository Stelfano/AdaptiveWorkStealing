<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AdaptiveWorkStealing: /home/stefano/Uni/Tirocinio/AdaptiveWorkStealing/source/Matchmaker.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AdaptiveWorkStealing<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Prototype for an adaptive work stealing distributed scheduler</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Matchmaker.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;mpi.h&quot;</code><br />
</div>
<p><a href="Matchmaker_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4a87dec580572701efbc15ef14fdc9f4" id="r_a4a87dec580572701efbc15ef14fdc9f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#a4a87dec580572701efbc15ef14fdc9f4">matchmakerMainLoop</a> (int num_proc, int *global_result, int chunk_size)</td></tr>
<tr class="memdesc:a4a87dec580572701efbc15ef14fdc9f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rappresenta il ciclo di operazione principale del Matchmaker.  <br /></td></tr>
<tr class="separator:a4a87dec580572701efbc15ef14fdc9f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42d947f6b6016c4726530807ccb674e" id="r_ad42d947f6b6016c4726530807ccb674e"><td class="memItemLeft" align="right" valign="top">MPI_Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#ad42d947f6b6016c4726530807ccb674e">waitControlMessages</a> (int *recv_flag)</td></tr>
<tr class="memdesc:ad42d947f6b6016c4726530807ccb674e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attende la ricezione di un messaggio di controllo da uno dei nodi.  <br /></td></tr>
<tr class="separator:ad42d947f6b6016c4726530807ccb674e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e4f54ecabf221c5f60ff26c52e7d2d5" id="r_a1e4f54ecabf221c5f60ff26c52e7d2d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#a1e4f54ecabf221c5f60ff26c52e7d2d5">checkTermination</a> (int *tagArray, int num_proc)</td></tr>
<tr class="memdesc:a1e4f54ecabf221c5f60ff26c52e7d2d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Controlla la terminazione dei processi.  <br /></td></tr>
<tr class="separator:a1e4f54ecabf221c5f60ff26c52e7d2d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3b37f33b0db975cd4061e9e67ab3284" id="r_ac3b37f33b0db975cd4061e9e67ab3284"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#ac3b37f33b0db975cd4061e9e67ab3284">findPossibleTarget</a> (int *tagArray, int num_proc, int victim)</td></tr>
<tr class="memdesc:ac3b37f33b0db975cd4061e9e67ab3284"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trova una possibile vittima per il work stealing.  <br /></td></tr>
<tr class="separator:ac3b37f33b0db975cd4061e9e67ab3284"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407b54881a888ef92f77e446619ced88" id="r_a407b54881a888ef92f77e446619ced88"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#a407b54881a888ef92f77e446619ced88">findPossibleReciever</a> (int *tagArray, int num_proc, int target)</td></tr>
<tr class="memdesc:a407b54881a888ef92f77e446619ced88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trova una possibile ricevente per il work stealing.  <br /></td></tr>
<tr class="separator:a407b54881a888ef92f77e446619ced88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c40b619e6213184cd688cfce052492" id="r_a82c40b619e6213184cd688cfce052492"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#a82c40b619e6213184cd688cfce052492">updateMetrics</a> (float *local_average, int num_proc, int *valueArray)</td></tr>
<tr class="memdesc:a82c40b619e6213184cd688cfce052492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aggiorna la media locale del matchmaker per il workstealing.  <br /></td></tr>
<tr class="separator:a82c40b619e6213184cd688cfce052492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec5ed6a911cf0e692d5ec07b0718ab9" id="r_a3ec5ed6a911cf0e692d5ec07b0718ab9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#a3ec5ed6a911cf0e692d5ec07b0718ab9">notifyMetrics</a> (float *local_average, int reciever, int *threshold)</td></tr>
<tr class="separator:a3ec5ed6a911cf0e692d5ec07b0718ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec5c77f729f5e7e233163df4cd6c370" id="r_abec5c77f729f5e7e233163df4cd6c370"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Matchmaker_8hpp.html#abec5c77f729f5e7e233163df4cd6c370">checkForDoubleSteal</a> (int *treshold, int *last_victim, int *last_target, int current_victim, int current_target)</td></tr>
<tr class="memdesc:abec5c77f729f5e7e233163df4cd6c370"><td class="mdescLeft">&#160;</td><td class="mdescRight">Controlla se ci sono stati eventi di double stealing e aggiorna il threshold di conseguenza.  <br /></td></tr>
<tr class="separator:abec5c77f729f5e7e233163df4cd6c370"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abec5c77f729f5e7e233163df4cd6c370" name="abec5c77f729f5e7e233163df4cd6c370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abec5c77f729f5e7e233163df4cd6c370">&#9670;&#160;</a></span>checkForDoubleSteal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void checkForDoubleSteal </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>last_victim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>last_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>current_victim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>current_target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Controlla se ci sono stati eventi di double stealing e aggiorna il threshold di conseguenza. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">threshold</td><td>Il valore attuale di threshold </td></tr>
    <tr><td class="paramname">last_victim</td><td>Ultima vittima di workstealing </td></tr>
    <tr><td class="paramname">last_target</td><td>Ultimo target di workstealing </td></tr>
    <tr><td class="paramname">current_victim</td><td>Vittima dello scambio attuale </td></tr>
    <tr><td class="paramname">current_target</td><td>Target dello scambio attuale </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1e4f54ecabf221c5f60ff26c52e7d2d5" name="a1e4f54ecabf221c5f60ff26c52e7d2d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e4f54ecabf221c5f60ff26c52e7d2d5">&#9670;&#160;</a></span>checkTermination()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int checkTermination </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tagArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_proc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Controlla la terminazione dei processi. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tagArray</td><td>Contiene i tag dei singoli processi, se tutti quanti hanno inviati i dati invia la terminazione </td></tr>
    <tr><td class="paramname">num_proc</td><td>Numero dei processi attivi </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a407b54881a888ef92f77e446619ced88" name="a407b54881a888ef92f77e446619ced88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407b54881a888ef92f77e446619ced88">&#9670;&#160;</a></span>findPossibleReciever()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int findPossibleReciever </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tagArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trova una possibile ricevente per il work stealing. </p>
<p>Questa funzione viene invocata non appena un core diventa Overworked, tentando di trovare immediatamente un bersaglio per poter eseguire il work stealing, viene fatta una ricerca lineare all'interno del vettore degli stati, può essere sostituito con l'utilizzo di una coda di priorità con valori sentinella Viene prima data precedenza ai core IDLE che vengono cercati per prima all'interno dell'array</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tagArray</td><td>Contiene il tag dei nodi worker </td></tr>
    <tr><td class="paramname">num_proc</td><td>Contiene il numero dei processi attivi sotto il matchmaker </td></tr>
    <tr><td class="paramname">victim</td><td>Contiene l'indice della vittima per evitare che si generino errori </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Indice della ricevente di work stealing </dd></dl>

</div>
</div>
<a id="ac3b37f33b0db975cd4061e9e67ab3284" name="ac3b37f33b0db975cd4061e9e67ab3284"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3b37f33b0db975cd4061e9e67ab3284">&#9670;&#160;</a></span>findPossibleTarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int findPossibleTarget </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>tagArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>victim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trova una possibile vittima per il work stealing. </p>
<p>Questa funzione viene invocata non appena un core diventa Underworked, tentando di trovare immediatamente un bersaglio per poter eseguire il work stealing, viene fatta una ricerca lineare all'interno del vettore degli stati, può essere sostituito con l'utilizzo di una coda di priorità con valori sentinella</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tagArray</td><td>Contiene il tag dei nodi worker </td></tr>
    <tr><td class="paramname">num_proc</td><td>Contiene il numero dei processi attivi sotto il matchmaker </td></tr>
    <tr><td class="paramname">victim</td><td>Contiene l'indice del ricevente per evitare che si generino errori </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Indice della vittima di work stealing </dd></dl>

</div>
</div>
<a id="a4a87dec580572701efbc15ef14fdc9f4" name="a4a87dec580572701efbc15ef14fdc9f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a87dec580572701efbc15ef14fdc9f4">&#9670;&#160;</a></span>matchmakerMainLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void matchmakerMainLoop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>global_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chunk_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rappresenta il ciclo di operazione principale del Matchmaker. </p>
<p>Contiene al suo interno le funzioni di creazione del vettore di stato, di comunicazione verso gli altri rank, di modifica delle metriche e di decisione del work stealing, questi elementi sono delegati a funzioni esterne ma sono richiamati qui, si occupa inoltre di decidere quando la computazione dei nodi finisce ed inizia la riduzione</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num_proc</td><td>Indica il numero di nodi sottostanti nell'albero gerarchico della computazione </td></tr>
    <tr><td class="paramname">global_result</td><td>Puntatore ad un elemento utilizzato nel main, conterrà il risultato finale della computazione </td></tr>
    <tr><td class="paramname">chunk_size</td><td>Grandezza del vettore inviato ad ogni processo, serve ad inizializzare le metriche del work stealing </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3ec5ed6a911cf0e692d5ec07b0718ab9" name="a3ec5ed6a911cf0e692d5ec07b0718ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec5ed6a911cf0e692d5ec07b0718ab9">&#9670;&#160;</a></span>notifyMetrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void notifyMetrics </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>local_average</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reciever</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a82c40b619e6213184cd688cfce052492" name="a82c40b619e6213184cd688cfce052492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c40b619e6213184cd688cfce052492">&#9670;&#160;</a></span>updateMetrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateMetrics </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>local_average</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_proc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>valueArray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aggiorna la media locale del matchmaker per il workstealing. </p>
<p>Aggiorna la media locale del matchmaker per tenere conto della situazione globale del sistema, la media reale verrà notificata ai worker ogni volta che questi cambieranno stato (in modo lazy), questo metodo aggiorna e ricalcola solo la media locale</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">local_average</td><td>Contiene il valore attuale di media del matchmaker </td></tr>
    <tr><td class="paramname">num_proc</td><td>Contiene il numero di processi sttivi sotto il matchmaker </td></tr>
    <tr><td class="paramname">valueArray</td><td>Contiene i valori di media forniti dai worker sottostanti </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad42d947f6b6016c4726530807ccb674e" name="ad42d947f6b6016c4726530807ccb674e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42d947f6b6016c4726530807ccb674e">&#9670;&#160;</a></span>waitControlMessages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Status waitControlMessages </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>recv_flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attende la ricezione di un messaggio di controllo da uno dei nodi. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recv_flag</td><td>Contiene il numero di elementi da elaborare per ogni nodo, viene inviato dal worker al matchmaker. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
