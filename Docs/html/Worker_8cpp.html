<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AdaptiveWorkStealing: /home/stefano/Uni/Tirocinio/AdaptiveWorkStealing/source/Worker.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AdaptiveWorkStealing<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Prototype for an adaptive work stealing distributed scheduler</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Worker.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="Worker_8hpp_source.html">Worker.hpp</a>&quot;</code><br />
<code>#include &quot;mpi.h&quot;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6cf4f84ce1249c9fa265b0d6d697faaa" id="r_a6cf4f84ce1249c9fa265b0d6d697faaa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a6cf4f84ce1249c9fa265b0d6d697faaa">OVERWORK</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a6cf4f84ce1249c9fa265b0d6d697faaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8290939dc02192ebf7028e5b45b0ff9" id="r_aa8290939dc02192ebf7028e5b45b0ff9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#aa8290939dc02192ebf7028e5b45b0ff9">STABLE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:aa8290939dc02192ebf7028e5b45b0ff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abafd49e7c13337429d6d835b3e8ce080" id="r_abafd49e7c13337429d6d835b3e8ce080"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#abafd49e7c13337429d6d835b3e8ce080">UNDERWORK</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:abafd49e7c13337429d6d835b3e8ce080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c21a7caee326d7803b94ae1952b27ca" id="r_a9c21a7caee326d7803b94ae1952b27ca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a9c21a7caee326d7803b94ae1952b27ca">IDLE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a9c21a7caee326d7803b94ae1952b27ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad9ae913bdfab20dd94ad04ee2d5b045" id="r_aad9ae913bdfab20dd94ad04ee2d5b045"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#aad9ae913bdfab20dd94ad04ee2d5b045">DATA</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:aad9ae913bdfab20dd94ad04ee2d5b045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a454ec9af8a278a80850ef1d5b575b081" id="r_a454ec9af8a278a80850ef1d5b575b081"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a454ec9af8a278a80850ef1d5b575b081">METRICS</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a454ec9af8a278a80850ef1d5b575b081"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3cb9ce84779e973b9002cb91dd4e2b87" id="r_a3cb9ce84779e973b9002cb91dd4e2b87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a3cb9ce84779e973b9002cb91dd4e2b87">probabilityIncreaseVectorSize</a> (vector&lt; int &gt; *buffer, int generatedNumber)</td></tr>
<tr class="memdesc:a3cb9ce84779e973b9002cb91dd4e2b87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aggiunge elementi al vettore.  <br /></td></tr>
<tr class="separator:a3cb9ce84779e973b9002cb91dd4e2b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad87949db8a71759dead75c2bf90261a8" id="r_ad87949db8a71759dead75c2bf90261a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#ad87949db8a71759dead75c2bf90261a8">declareStatus</a> (int *buffer_size, int status)</td></tr>
<tr class="separator:ad87949db8a71759dead75c2bf90261a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67832aed811528fe18bd6735765c511d" id="r_a67832aed811528fe18bd6735765c511d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a67832aed811528fe18bd6735765c511d">local_reduction</a> (vector&lt; int &gt; *buffer, float start_average, int start_treshold)</td></tr>
<tr class="memdesc:a67832aed811528fe18bd6735765c511d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funzione di riduzione locale per il worker.  <br /></td></tr>
<tr class="separator:a67832aed811528fe18bd6735765c511d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e762d937d466a0581096313ff725f8f" id="r_a2e762d937d466a0581096313ff725f8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a2e762d937d466a0581096313ff725f8f">sendStatusFunction</a> (vector&lt; int &gt; *buffer, float *local_average, int *threshold)</td></tr>
<tr class="memdesc:a2e762d937d466a0581096313ff725f8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Funzione che regola la comunicazione Worker -&gt; Matchmaker.  <br /></td></tr>
<tr class="separator:a2e762d937d466a0581096313ff725f8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b7f20238d16d4a3d14e288869264891" id="r_a1b7f20238d16d4a3d14e288869264891"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Worker_8cpp.html#a1b7f20238d16d4a3d14e288869264891">recieveMessageFromMatchmaker</a> (float *local_average, int *threshold)</td></tr>
<tr class="separator:a1b7f20238d16d4a3d14e288869264891"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aad9ae913bdfab20dd94ad04ee2d5b045" name="aad9ae913bdfab20dd94ad04ee2d5b045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9ae913bdfab20dd94ad04ee2d5b045">&#9670;&#160;</a></span>DATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATA&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tag utilizzato nei messaggi per segnalare al worker che i dati contenuti nel messaggio sono dati computazionali e non messaggi di stato sul sistema </p>

</div>
</div>
<a id="a9c21a7caee326d7803b94ae1952b27ca" name="a9c21a7caee326d7803b94ae1952b27ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c21a7caee326d7803b94ae1952b27ca">&#9670;&#160;</a></span>IDLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IDLE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segnala status di Idle, in questo stato un worker deve essere target di work stealing al più presto per massimizzare le prestazioni, quando un core raggiunge questo stato viene invocata la procedura del targeting e viene data priorità al targeting verso core Idle </p>

</div>
</div>
<a id="a454ec9af8a278a80850ef1d5b575b081" name="a454ec9af8a278a80850ef1d5b575b081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a454ec9af8a278a80850ef1d5b575b081">&#9670;&#160;</a></span>METRICS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define METRICS&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tag utilizzato per indicare che il contenuto dei messaggi è un aggiornamento sulle metriche di sistema </p>

</div>
</div>
<a id="a6cf4f84ce1249c9fa265b0d6d697faaa" name="a6cf4f84ce1249c9fa265b0d6d697faaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf4f84ce1249c9fa265b0d6d697faaa">&#9670;&#160;</a></span>OVERWORK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OVERWORK&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segnala status di overworking, in questo stato un worker non può essere target di work stealing (non può ricevere altri dati), non appena questo status è segnalato viene invocata una procedura per determinare un target a cui dare parte del lavoro del nodo sovraccarico </p>

</div>
</div>
<a id="aa8290939dc02192ebf7028e5b45b0ff9" name="aa8290939dc02192ebf7028e5b45b0ff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8290939dc02192ebf7028e5b45b0ff9">&#9670;&#160;</a></span>STABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STABLE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segnala status di stable, in questo stato un worker non può essere vittima o target di una procedura di work stealing, il nodo è interamente occupato ad elaborare e computare i dati attuali </p>

</div>
</div>
<a id="abafd49e7c13337429d6d835b3e8ce080" name="abafd49e7c13337429d6d835b3e8ce080"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abafd49e7c13337429d6d835b3e8ce080">&#9670;&#160;</a></span>UNDERWORK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNDERWORK&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Segnala status di underwork, in questo stato un worker può essere target di work stealing, viene fatto ciò per evitare che il worker tocchi lo stato di IDLE che cerchiamo di evitare a tutti i costi per sfruttare al massimo il sistema </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad87949db8a71759dead75c2bf90261a8" name="ad87949db8a71759dead75c2bf90261a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad87949db8a71759dead75c2bf90261a8">&#9670;&#160;</a></span>declareStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void declareStatus </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a67832aed811528fe18bd6735765c511d" name="a67832aed811528fe18bd6735765c511d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67832aed811528fe18bd6735765c511d">&#9670;&#160;</a></span>local_reduction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int local_reduction </td>
          <td>(</td>
          <td class="paramtype">vector&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>start_average</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_treshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funzione di riduzione locale per il worker. </p>
<p>Questa funzione determina il comportamento dei worker, all'interno viene eseguito il main loop della riduzione e vengono lanciati i thread che regolano la comunicazione dei worker con il matchmaker e lo scambio della metrica</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Buffer di contenimento per il valore finale </td></tr>
    <tr><td class="paramname">start_average</td><td>Valore iniziale distribuito a tutti i core </td></tr>
    <tr><td class="paramname">start_treshold</td><td>Valore di threshold iniziale </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int Valore finale computato </dd></dl>

</div>
</div>
<a id="a3cb9ce84779e973b9002cb91dd4e2b87" name="a3cb9ce84779e973b9002cb91dd4e2b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cb9ce84779e973b9002cb91dd4e2b87">&#9670;&#160;</a></span>probabilityIncreaseVectorSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void probabilityIncreaseVectorSize </td>
          <td>(</td>
          <td class="paramtype">vector&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generatedNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aggiunge elementi al vettore. </p>
<p>Funzione di aggiunta degli elementi al vettore della riduzione, se negativo verrano eliminati degli elementi</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Vettore di riduzione </td></tr>
    <tr><td class="paramname">generatedNumber</td><td>Numero di elementi da aggiungere </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1b7f20238d16d4a3d14e288869264891" name="a1b7f20238d16d4a3d14e288869264891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b7f20238d16d4a3d14e288869264891">&#9670;&#160;</a></span>recieveMessageFromMatchmaker()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recieveMessageFromMatchmaker </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>local_average</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2e762d937d466a0581096313ff725f8f" name="a2e762d937d466a0581096313ff725f8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e762d937d466a0581096313ff725f8f">&#9670;&#160;</a></span>sendStatusFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendStatusFunction </td>
          <td>(</td>
          <td class="paramtype">vector&lt; int &gt; *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>local_average</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Funzione che regola la comunicazione Worker -&gt; Matchmaker. </p>
<p>Questa funzione lanciata da un thread all'interno del mainloop del worker serve a notificare il matchmaker dei cambi di stato di un worker e inviare valori sulla metrica locale del worker</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Vettore contenete i valori da ridurre, usiamo la funzione size per indicare il numero di elementi rimanenti </td></tr>
    <tr><td class="paramname">local_average</td><td>Media locale da comunicare al matchmaker </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold usato per indicare lo stato al matchmaker </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
